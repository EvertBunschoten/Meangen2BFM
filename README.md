Meangen2BFM is a program which allows for the creation of 2D and 3D body-force and (future) blade computation meshes for axial turbomachinery analysis from Meangen input. The user specifies the machine type, number of stages, duty coefficients, performance parameters and blade thickness parameters and the program creates a 2D or 3D mesh, alongside the input file required for body-force analysis in SU2. 

For the program to work, installation of Parablade is required(the 'body-force' branch), GMesh and UMG2 and their installation location has to have been added to PATH and PYTHONPATH. There is a copy of Meangen already present in the 'executables' folder. The following lines should be added to the .bashrc file:

export M2BFM="<path to Meangen2BFM folder>"
export PATH=$PATH:"<path to Meangen2BFM folder>/executables/"
export PYTHONPATH=$PYTHONPATH:"<path to Meangen2BFM folder>/executables/"

A template of the inputfile to be used can be found in the 'templates' folder under the name 'M2P.cfg'. More detailed explanations on all the input options can be found in there.

To execute the program, the user has to have the  file and the 'Mesh_params.cfg' file in the target directory. By then executing the following command in the terminal,

Meangen2BFM.py inputfile.cfg

the program will initiate and start generating output folders for Meangen and Parablade, alongside a mesh suitable for body-force analysis or blade computation. Currently, full integration with SU2 is not yet functional, so SU2 has to be initiated manually. A template of the SU2 configuration file required for the body-force analysis can be found in the 'templates' file under the name 'BFM_comp.cfg'. 

To perform a body-force simulation, the SU2 body_force_turbo branch has to be cloned on the user's machine. In the body-force template configuration file("BFM_comp.cfg"), the user can adjust several things regarding the body-force model. The first is the body-force option(BODY_FORCE). When selecting YES here and setting the 
BODY_FORCE_TYPE to VARIABLE_BF, the body-force model within SU2 will be used. The BODY_FORCE_ROTATION input asks for the rotation rate of the rotor rows of the machine in rpm, with the rotation axis being the positive x-axis. The BODY_FORCE_RADIUS input asks for the design radius of the geometry. This option will
only really be used for 2D analyses. The other inputs are equivalent to more general SU2 inputs, such as inlet and outlet conditions and fluid parameters. The final input for the body-force model is the BODY-FORCE_INPUT_FILENAME. Here, the file name of the body-force interpolation input file has to be specified. This file is automatically
generated by Meangen2BFM.py and the file name can be changed in its input file. 

To summarize, the full process of performing a body-force analysis from scratch is as follows:

Step 1: fill in Meangen2BFM input file by specifying all required design paramters as listed in the template file named M2P.cfg and move this file to the working directory. 

Step 2: In the working directory, type 

Meangen2BFM.py inputfile.cfg

in the terminal, where inputfile.cfg is the name of the Meangen2BFM input file. This step will generate the mesh and body-force interpolation file for SU2.

Step 3: Copy the BFM_comp.cfg file from the template directory to the working directory. Go to the "MeangenOutput" folder in the working directory and open "meandesign.out". From this file, the user can read the outlet static pressure and copy this value to the OUTLET_MARKER boundary condition in BFM_comp.cfg.

Step 4: Fill in the inlet conditions, design radius and rotation speed of the machine and check that the mesh and body-force interpolation file names are correct.

Step 5: For the body-force analysis to be initialized, the general command for SU2 CFD simulations can be used.

SU2_CFD BFM_comp.cfg

This will initialize the simulation and generate the flow field and convergence history files. Currently, the body-force magnitude is not included in the flow field output, but this will be a feature in the near future.


